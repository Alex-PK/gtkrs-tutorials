<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Simple Common Mark Editor - </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <base href="../">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">

        <!-- MathJax -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Fetch JQuery from CDN but have a local fallback -->
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='jquery.js'%3E%3C/script%3E"));
            }
        </script>
    </head>
    <body class="light">
        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme = localStorage.getItem('theme');
            if (theme == null) { theme = 'light'; }
            $('body').removeClass().addClass(theme);
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = localStorage.getItem('sidebar');
            if (sidebar === "hidden") { $("html").addClass("sidebar-hidden") }
            else if (sidebar === "visible") { $("html").addClass("sidebar-visible") }
        </script>

        <div id="sidebar" class="sidebar">
            <ul class="chapter"><li><a href="./introduction.html"><strong>1.</strong> Introduction</a></li><li><a href="./chapter_01.html"><strong>2.</strong> Window With A Header Bar</a></li><li><a href="./chapter_02/index.html"><strong>3.</strong> Button Boxer</a></li><li><ul class="section"><li><a href="./chapter_02/objects.html"><strong>3.1.</strong> Boxes, Buttons, &amp; Labels</a></li><li><a href="./chapter_02/state.html"><strong>3.2.</strong> Maintaining External State</a></li><li><a href="./chapter_02/ui.html"><strong>3.3.</strong> Creating the UI Structure</a></li><li><a href="./chapter_02/programming.html"><strong>3.4.</strong> Programming the UI</a></li><li><a href="./chapter_02/review.html"><strong>3.5.</strong> Conclusion &amp; Review</a></li></ul></li><li><a href="./chapter_03/index.html"><strong>4.</strong> HTML Articler</a></li><li><ul class="section"><li><a href="./chapter_03/objects.html"><strong>4.1.</strong> Entries, Panes, Scrolled Windows, &amp; Text Views</a></li><li><a href="./chapter_03/horrorshow.html"><strong>4.2.</strong> Horrorshow HTML Templating</a></li><li><a href="./chapter_03/ui.html"><strong>4.3.</strong> Creating the UI Structure</a></li><li><a href="./chapter_03/programming.html"><strong>4.4.</strong> Programming the UI</a></li><li><a href="./chapter_03/review.html"><strong>4.5.</strong> Conclusion &amp; Review</a></li></ul></li><li><a href="./chapter_04/index.html" class="active"><strong>5.</strong> Simple Common Mark Editor</a></li><li><ul class="section"><li><a href="./chapter_04/objects.html"><strong>5.1.</strong> Source Views, Web Views, &amp; File Dialogs</a></li><li><a href="./chapter_04/mods.html"><strong>5.2.</strong> Setting Up Modules</a></li><li><a href="./chapter_04/misc.html"><strong>5.3.</strong> The ui/misc.rs Module</a></li><li><a href="./chapter_04/ui.html"><strong>5.4.</strong> Creating the UI Structure</a></li><li><a href="./chapter_04/state.html"><strong>5.5.</strong> Maintaining External State</a></li><li><a href="./chapter_04/programming.html"><strong>5.6.</strong> Connecting Events</a></li><li><a href="./chapter_04/markdown_to_html.html"><strong>5.7.</strong> Markdown to HTML</a></li><li><a href="./chapter_04/webviews.html"><strong>5.8.</strong> Updating WebViews</a></li><li><a href="./chapter_04/markdown_to_html.html"><strong>5.9.</strong> Markdown to HTML</a></li><li><a href="./chapter_04/file_choosers.html"><strong>5.10.</strong> File Chooser Dialogs</a></li><li><a href="./chapter_04/open_button.html"><strong>5.11.</strong> Programming Open Button</a></li><li><a href="./chapter_04/save_buttons.html"><strong>5.12.</strong> Programming the Save Buttons</a></li><li><a href="./chapter_04/keys.html"><strong>5.13.</strong> Binding Keys</a></li><li><a href="./chapter_04/review.html"><strong>5.14.</strong> Conclusion &amp; Review</a></li></ul></li><li><a href="./chapter_05/index.html"><strong>6.</strong> Advanced Common Mark Editor</a></li><li><ul class="section"><li><a href="./chapter_05/objects.html"><strong>6.1.</strong> Menu Buttons, Notebooks, &amp; Stacks</a></li></ul></li><li><a href="./chapter_06/index.html"><strong>7.</strong> Content Management System</a></li></ul>
        </div>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar" class="menu-bar">
                    <div class="left-buttons">
                        <i id="sidebar-toggle" class="fa fa-bars"></i>
                        <i id="theme-toggle" class="fa fa-paint-brush"></i>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <i id="print-button" class="fa fa-print" title="Print this book"></i>
                    </div>
                </div>

                <div id="content" class="content">
                    <a class="header" href="./chapter_04/index.html#simple-common-mark-editor" id="simple-common-mark-editor"><h1>Simple Common Mark Editor</h1></a>
<p><img src="images/ch04_complete.png" /></p>
<blockquote>
<p>The source code for this chapter can be found <a href="https://github.com/mmstick/gtkrs-tutorials/tree/master/demos/chapter_04">here</a>.</p>
</blockquote>
<p>In this chapter, we will create a useful program for editing text with
Markdown syntax, particularly the Common Mark flavor of Markdown, and
rendering that text into a live HTML preview as text is entered into
the program. We will also be using file chooser dialogs for opening
and saving files, and hashing the buffer to know when the save button
should be enabled. Once completed, you should have an understanding of
how to use not only the <strong>gtk</strong> crate, but <strong>gdk</strong>, <strong>pango</strong>,
<strong>webkit2gtk</strong>, and <strong>sourceview</strong> as well.</p>
<blockquote>
<p>This chapter was actually written with the completed program that
we are going to build. So you could say that this tutorial is now
fully self-hosted and is eating it's own dog food.</p>
</blockquote>
<blockquote>
<p>HTML is allowed to be written in-line within this flavor of Markdown,
so it is possible to mix and match HTML with Markdown in the editor,
and to see it rendered properly on the right.</p>
</blockquote>
<a class="header" href="./chapter_04/index.html#prerequisites" id="prerequisites"><h2>Prerequisites</h2></a>
<p>It's good to have an understanding of how to use types like <strong>RwLock</strong>
and <strong>Mutex</strong> before proceeding, as they will be utilized to maintain
external state of a custom type. They allow for otherwise immutable
values to be mutably borrowed across multiple threads and closures.</p>
<a class="header" href="./chapter_04/index.html#dependencies" id="dependencies"><h2>Dependencies</h2></a>
<p>Your dependency list should look similar to the following:</p>
<pre><code class="language-toml">[dependencies]
gdk = &quot;0.6.0&quot;
horrorshow = &quot;0.6.2&quot;
pango = &quot;0.2.0&quot;
pulldown-cmark = &quot;0.1.0&quot;
sourceview = &quot;0.2&quot;
tiny-keccak = &quot;1.4.0&quot;
webkit2gtk = &quot;0.2&quot;

[dependencies.gtk]
features = [&quot;v3_22&quot;]
version = &quot;0.2&quot;
</code></pre>
<a class="header" href="./chapter_04/index.html#pulldown-cmark" id="pulldown-cmark"><h3>pulldown-cmark</h3></a>
<p>One will note that we have introduced a few new crates to the mix. Google
has provided the <a href="https://github.com/google/pulldown-cmark">pulldown-cmark crate</a>,
which provides a pull parser for Common Mark Markdown syntax, and thereby allows
us to convert Markdown into HTML.</p>
<a class="header" href="./chapter_04/index.html#tiny-keccak" id="tiny-keccak"><h3>tiny-keccak</h3></a>
<p>We will be using a hashing algorithm to determine when the save button should be
sensitive or not. Basically, we will hash the buffer upon each key press and compare
it to the saved file's hash. If the hashes match, the save button shall be enabled.
Otherwise, the save button will be disabled.s</p>
<a class="header" href="./chapter_04/index.html#sourceview" id="sourceview"><h3>sourceview</h3></a>
<p>This will provide access to the <strong>GtkSourceView</strong> widget that we will be using
to create the code editor that our editor will be using for editing Markdown.</p>
<a class="header" href="./chapter_04/index.html#webkit2gtk" id="webkit2gtk"><h3>webkit2gtk</h3></a>
<p>This will provide the <strong>GtkWebView</strong> widget which we will be using to render
a live preview of our edited Markdown.</p>
<a class="header" href="./chapter_04/index.html#pango" id="pango"><h3>pango</h3></a>
<p>This will enable us to edit the font in the <strong>GtkSourceView</strong>.</p>
<a class="header" href="./chapter_04/index.html#gdk" id="gdk"><h3>gdk</h3></a>
<p>We will use this to act upon certain key presses</p>

                </div>

                <!-- Mobile navigation buttons -->
                
                    <a href="./chapter_03/review.html" class="mobile-nav-chapters previous">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="./chapter_04/objects.html" class="mobile-nav-chapters next">
                        <i class="fa fa-angle-right"></i>
                    </a>
                

            </div>

            
                <a href="./chapter_03/review.html" class="nav-chapters previous" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-left"></i>
                </a>
            

            
                <a href="./chapter_04/objects.html" class="nav-chapters next" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-right"></i>
                </a>
            

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if ($(".fa").css("font-family") !== "FontAwesome") {
                $('<link rel="stylesheet" type="text/css" href="_FontAwesome/css/font-awesome.css">').prependTo('head');
            }
        </script>

        <!-- Livereload script (if served using the cli tool) -->
        
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3001");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload(true); // force reload from server (not from cache)
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
    

        


        <script src="highlight.js"></script>
        <script src="book.js"></script>
    </body>
</html>
